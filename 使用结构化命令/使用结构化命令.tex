% !TeX spellcheck = en_US
%% 字体：方正静蕾简体
%%		 方正粗宋
\documentclass[a4paper,left=1.5cm,right=1.5cm,11pt]{article}

\usepackage[utf8]{inputenc}
\usepackage{fontspec}
\usepackage{cite}
\usepackage{xeCJK}
\usepackage{indentfirst}
\usepackage{titlesec}
\usepackage{etoolbox}%
\makeatletter
\patchcmd{\ttlh@hang}{\parindent\z@}{\parindent\z@\leavevmode}{}{}%
\patchcmd{\ttlh@hang}{\noindent}{}{}{}%
\makeatother

\usepackage{hyperref}
\usepackage{longtable}
\usepackage{empheq}
\usepackage{graphicx}
\usepackage{float}
\usepackage{rotating}
\usepackage{subfigure}
\usepackage{tabu}
\usepackage{amsmath}
\usepackage{setspace}
\usepackage{amsfonts}
\usepackage{appendix}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{geometry}
\setcounter{secnumdepth}{4}
%\titleformat*{\section}{\LARGE}
%\renewcommand\refname{参考文献}
%\titleformat{\chapter}{\centering\bfseries\huge}{}{0.7em}{}{}
\titleformat{\section}{\LARGE\bf}{\thesection}{1em}{}{}
\titleformat{\subsection}{\Large\bfseries}{\thesubsection}{1em}{}{}
\titleformat{\subsubsection}{\large\bfseries}{\thesubsubsection}{1em}{}{}
\renewcommand{\contentsname}{{ \centerline{目{  } 录}}}
\setCJKfamilyfont{cjkhwxk}{STXINGKA.TTF}
%\setCJKfamilyfont{cjkhwxk}{华文行楷}
%\setCJKfamilyfont{cjkfzcs}{方正粗宋简体}
%\newcommand*{\cjkfzcs}{\CJKfamily{cjkfzcs}}
\newcommand*{\cjkhwxk}{\CJKfamily{cjkhwxk}}
%\newfontfamily\wryh{Microsoft YaHei}
%\newfontfamily\hwzs{华文中宋}
%\newfontfamily\hwst{华文宋体}
%\newfontfamily\hwfs{华文仿宋}
%\newfontfamily\jljt{方正静蕾简体}
%\newfontfamily\hwxk{华文行楷}
\newcommand{\verylarge}{\fontsize{60pt}{\baselineskip}\selectfont}  
\newcommand{\chuhao}{\fontsize{44.9pt}{\baselineskip}\selectfont}  
\newcommand{\xiaochu}{\fontsize{38.5pt}{\baselineskip}\selectfont}  
\newcommand{\yihao}{\fontsize{27.8pt}{\baselineskip}\selectfont}  
\newcommand{\xiaoyi}{\fontsize{25.7pt}{\baselineskip}\selectfont}  
\newcommand{\erhao}{\fontsize{23.5pt}{\baselineskip}\selectfont}  
\newcommand{\xiaoerhao}{\fontsize{19.3pt}{\baselineskip}\selectfont} 
\newcommand{\sihao}{\fontsize{14pt}{\baselineskip}\selectfont}      % 字号设置  
\newcommand{\xiaosihao}{\fontsize{12pt}{\baselineskip}\selectfont}  % 字号设置  
\newcommand{\wuhao}{\fontsize{10.5pt}{\baselineskip}\selectfont}    % 字号设置  
\newcommand{\xiaowuhao}{\fontsize{9pt}{\baselineskip}\selectfont}   % 字号设置  
\newcommand{\liuhao}{\fontsize{7.875pt}{\baselineskip}\selectfont}  % 字号设置  
\newcommand{\qihao}{\fontsize{5.25pt}{\baselineskip}\selectfont}    % 字号设置 

\usepackage{diagbox}
\usepackage{multirow}
\boldmath
\XeTeXlinebreaklocale "zh"
\XeTeXlinebreakskip = 0pt plus 1pt minus 0.1pt
\definecolor{cred}{rgb}{0.8,0.8,0.8}
\definecolor{cgreen}{rgb}{0,0.3,0}
\definecolor{cpurple}{rgb}{0.5,0,0.35}
\definecolor{cdocblue}{rgb}{0,0,0.3}
\definecolor{cdark}{rgb}{0.95,1.0,1.0}
\lstset{
	language=bash,
	numbers=left,
	numberstyle=\tiny\color{black},
	showspaces=false,
	showstringspaces=false,
	basicstyle=\scriptsize,
	keywordstyle=\color{purple},
	commentstyle=\itshape\color{cgreen},
	stringstyle=\color{blue},
	frame=lines,
	% escapeinside=``,
	extendedchars=true, 
	xleftmargin=1em,
	xrightmargin=1em, 
	backgroundcolor=\color{cred},
	aboveskip=1em,
	breaklines=true,
	tabsize=4
} 

%\newfontfamily{\consolas}{Consolas}
%\newfontfamily{\monaco}{Monaco}
%\setmonofont[Mapping={}]{Consolas}	%英文引号之类的正常显示，相当于设置英文字体
%\setsansfont{Consolas} %设置英文字体 Monaco, Consolas,  Fantasque Sans Mono
%\setmainfont{Times New Roman}
%\setCJKmainfont{STZHONGS.TTF}
%\setmonofont{Consolas}
% \newfontfamily{\consolas}{YaHeiConsolas.ttf}
\newfontfamily{\monaco}{MONACO.TTF}
\setCJKmainfont{STZHONGS.TTF}
%\setmainfont{MONACO.TTF}
%\setsansfont{MONACO.TTF}

\newcommand{\fic}[1]{\begin{figure}[H]
		\center
		\includegraphics[width=0.8\textwidth]{#1}
	\end{figure}}
	
\newcommand{\sizedfic}[2]{\begin{figure}[H]
		\center
		\includegraphics[width=#1\textwidth]{#2}
	\end{figure}}

\newcommand{\codefile}[1]{\lstinputlisting{#1}}

\newcommand{\interval}{\vspace{0.5em}}

\newcommand{\tablestart}{
	\interval
	\begin{longtable}{p{2cm}p{10cm}}
	\hline}
\newcommand{\tableend}{
	\hline
	\end{longtable}
	\interval}

% 改变段间隔
\setlength{\parskip}{0.2em}
\linespread{1.1}

\usepackage{lastpage}
\usepackage{fancyhdr}
\pagestyle{fancy}
\lhead{\space \qquad \space}
\chead{使用结构化命令 \qquad}
\rhead{\qquad\thepage/\pageref{LastPage}}
\begin{document}

\tableofcontents

\clearpage

\section{if-then语句}
	if-then语句的格式如下所示：
	\begin{lstlisting}
	if command
	then
		commands
	fi
	\end{lstlisting}

	这个语句的意思是，如果成功执行command命令，那么将执行then后面的所有命令。
	如果命令的退出状态是0以外的其他值，那么then后面的命令将不会执行。例子如下：
	\begin{lstlisting}
	#!/bin/bash
	if date
	then
		echo "it worked"
	fi
	\end{lstlisting}

	需要注意的是，command部分可以有多条命令，这些命令之间用分号隔开，是否执行commands部分由command的最后一条命令的退出状态决定。\par

	if-then语句的另一种形式为：
	\begin{lstlisting}
	if command; then
		commands
	fi
	\end{lstlisting}

\section{if-then-else语句}
	if-then-else语句的格式如下所示：
	\begin{lstlisting}
	if command
	then
		commands
	else
		commands
	fi
	\end{lstlisting}

\section{嵌套if语句}
	嵌套if语句的格式如下所示：
	\begin{lstlisting}
	if command1
	then
		commands
	elif command2
	then
		commands
	fi
	\end{lstlisting}

	可以使用多个elif语句，格式如下：
	\begin{lstlisting}
	if command1
	then
		commands
	elif command2
	then
		commands
	elif command3
	then
		commands
	elif command4
	then
		commands
	fi
	\end{lstlisting}

\section{test语句}
	test命令提供了一种检测if-then语句中条件是否为真的方法。
	如果test命令中列出的条件评估值为true，那么test命令的退出状态为0，否则为其他值。
	test命令的格式如下所示：
	\begin{lstlisting}
	test condition
	\end{lstlisting}

	在if-then语句中使用格式如下：
	\begin{lstlisting}
	if test condition
	then
		commands
	fi
	\end{lstlisting}

	可以使用[]来声明test命令，格式如下：
	\begin{lstlisting}
	if [condition ]
	then
		commands
	fi
	\end{lstlisting}

	需要注意的是，在前半个方括号的后面必须有个空格，在后半个方括号的前面也必须有个空格，否则会发生语法错误。

\subsection{数值比较}
	以下是数值比较中的格式：
	\fic{1.png}

	例子如下所示：
	\begin{lstlisting}
	#!/bin/bash
	val1=10
	val2=11

	if [ $val1 -gt 5 ]
	then
		echo "The test value $val1 is greater than 5"
	fi

	if [ $val1 -eq $val2 ]
	then
		echo "The values are equal"
	else
		echo "The values are different"
	fi
	\end{lstlisting}

	需要注意的是，数值比较仅限于整数，如果使用浮点数将报错。

\subsection{字符串比较}
	字符串比较的格式如下所示：
	\fic{2.png}

	需要注意的是，使用大于号或小于号的时候，需要在它们前面加上反义符号，否则会被当作重定位符号。例子如下所示：
	\begin{lstlisting}
	#!/bin/bash
	val1=baseball
	val2=hockey

	if [ $val1 \> $val2 ]
	then
		echo "$val1 is greater than $val2"
	else
		echo "$val1 is less than $val2"
	fi
	\end{lstlisting}

	需要注意的是，test命令使用ASCII码的大小对字符串进行排序。

\subsection{文本比较}
	test命令可以测试linux文件系统上的文件状态和路径，如下所示：
	\begin{longtable}{p{2cm}p{6cm}}
	\hline
	-d file & 检查file是否存在并且是一个目录 \\
	\hline
	-e file & 检查file是否存在 \\
	\hline
	-f file & 检查file是否存在并且是一个文件 \\
	\hline
	-r file & 检查file是否存在并且可读 \\
	\hline
	-s file & 检查file是否存在并且不为空 \\
	\hline
	-w file & 检查file是否存在并且可写 \\
	\hline
	-x file & 检查file是否存在并且可执行 \\
	\hline
	-O file & 检查file是否存在并且被当前用户拥有 \\
	\hline
	-G file & 检查file是否存在并且默认组是否为当前用户组 \\
	\hline
	file1 -nt file2 & 检查file1是否比file2新 \\
	\hline
	file1 -ot file2 & 检查file1是否比file2旧 \\
	\hline
	\end{longtable}

	需要注意的是，如果要在-nt或-ot比较中使用文件，必须保证两个文件存在，否则返回值为false。

\section{复合条件检查}
	两个条件的与如下所示：
	\begin{lstlisting}
	[ condition1 ] && [ condition2 ]
	\end{lstlisting}

	两个条件的或如下所示：
	\begin{lstlisting}
	[ condition1 ] || [ condition2 ]
	\end{lstlisting}

\section{if-then的高级特征}
\subsection{使用双圆括号}
	双圆括号的格式如下所示：
	\begin{lstlisting}
	(( expression ))
	\end{lstlisting}
	双圆括号中允许在比较中包含高级数学公式，还可以使用一些常用的数学符号，如下图所示：
	\fic{3.png}

	例子如下所示：
	\begin{lstlisting}
	#!/bin/bash
	val1=10

	if (( $val1**2 > 90 ))
	then
		(( val2 = $val1**2 ))
		echo "The square of $val1 is $val2"
	fi
	\end{lstlisting}

	需要注意的是，在双圆括号中，<和>都不会被认为是重定向符号。反正在双圆括号中可以使用在c语言中常用的数学符号。

\subsection{使用双方括号}
	双方括号的格式如下所示：
	\begin{lstlisting}
	[[ expression ]]
	\end{lstlisting}

	双方括号提供了模式匹配功能，可以使用正则表达式，例子如下所示：
	\begin{lstlisting}
	#!/bin/bash
	# r*就是正则表达式
	if [[ $USER == r* ]]
	then
		echo "Hello $USER"
	else
		echo "Sorry, I don't know you"
	fi
	\end{lstlisting}

\section{case命令}
	case命令的格式如下所示：
	\begin{lstlisting}
	case variable in
	pattern1 | pattern2) 
		commands1;;
	pattern3) 
		commands2;;
	*) 
	default	commands;;
	esac
	\end{lstlisting}

	可以在一行中列出多个模式，使用竖条操作符将每个模式分开。星号可以匹配任何的模式。例子如下：
	\begin{lstlisting}
	#!/bin/bash
	case $USER in
	rich | barbara)
		echo "Welcome, $USER"
		echo "Please enjoy your visit";;
	testing)
		echo "Special testing account";;
	jessica)
		echo "Don't forget to log off when you are done";;
	*)
		echo "Sorry, you are not allowed here"
	esac
	\end{lstlisting}

\section{for命令}
	for命令的格式如下所示：
	\begin{lstlisting}
	for var in list
	do
		commands
	done
	\end{lstlisting}

	参数list用于提供一系列用于迭代的值，例子如下所示：
	\begin{lstlisting}
	#!/bin/bash
	for test in Alabama Alaska Arizona Arknansas California Colorado
	do
		echo "The next state is $test"
	done
	\end{lstlisting}

	list也可以是一个变量，如下例所示：
	\begin{lstlisting}
	#!/bin/bash
	list="Alabama Alaska Arizona Arknansas California Colorado"
	list=$list" Connecticut"

	for state in $list
	do
		echo "Have you ever visited $state?"
	done
	\end{lstlisting}

	list还可以是命令的输出，如下例所示：
	\begin{lstlisting}
	#!/bin/bash
	file="states"

	for state in `cat $file`
	do
		echo "Visit beautiful $state"
	done
	\end{lstlisting}

	list参数还可以使用通配符，使用for语句遍历文件的例子如下：
	\begin{lstlisting}
	#!/bin/bash

	for file in /home/rich/test/*
	do
		# 加双引号是为了避免文件名有空格
		if [ -d "$file" ]
		then
			echo "$file is a directory"
		elif [ -f "$file" ]
		then
			echo "$file is a file"
		fi
	done
	\end{lstlisting}

\section{C式的for命令}
	bash中的C式for循环的格式如下所示：
	\begin{lstlisting}
	for (( variable assignment; condition; iteration process ))
	\end{lstlisting}

	这里的for循环和C语言完全一样，例子如下所示：
	\begin{lstlisting}
	#!/bin/bash
	for (( i=1; i <= 10; i++ ))
	do
		echo "The next number is $i"
	done
	\end{lstlisting}

	和C语言中的for循环一样，bash中的C式循环也可以使用多个变量，例子如下所示：
	\begin{lstlisting}
	#!/bin/bash

	for (( a=1, b=10; a <= 10; a++, b-- ))
	do
		echo "$a - $b"
	done
	\end{lstlisting}

\section{while命令}
	while命令的条件判断和if-then语句一样，也可以使用test命令来辅助条件判断，格式如下所示：
	\begin{lstlisting}
	#!/bin/bash
	while test command
	do
		commands
	done
	\end{lstlisting}

	使用while循环的例子如下所示：
	\begin{lstlisting}
	#!/bin/bash
	var1=10

	while [ $var1 -gt 0 ]
	do
		echo $var1
		var1=$[ $var1 - 1 ]
	done
	\end{lstlisting}

	while循环可以使用多条命令，但是只以最后一条为准，如下例所示：
	\begin{lstlisting}
	#!/bin/bash
	var1=10

	while echo $var1
		  [ $var1 -ge 0 ]
	do
		echo "This is inside the loop"
		var1=$[ $var1-1 ]
	done
	\end{lstlisting}

\section{until命令}
	until命令格式如下：
	\begin{lstlisting}
	until test command
	do
		other commands
	done
	\end{lstlisting}

	使用例子如下：
	\begin{lstlisting}
	#!/bin/bash
	var1=100

	until echo $var1
		  [ $var1 -eq 0 ]
	do
		echo "Inside the loop: $var1"
		var1=$[ $var1-25 ]
	done
	\end{lstlisting}

\section{文件数据的循环}
	通过改变字段分隔符IFS这个环境变量，可以通过修改IFS来修改字段分隔符。\par
	如果想只识别换行符，IFS值为：
	\begin{lstlisting}
	# 注意换行符前面要带一个$
	IFS=$'\n'
	\end{lstlisting}

	如果想识别冒号，IFS值为：
	\begin{lstlisting}
	IFS=:
	\end{lstlisting}

	例子如下：
	\begin{lstlisting}
	#!/bin/bash
	IFS.OLD=$IFS
	IFS=$'\n'
	for entry in `cat /etc/passwd`
	do
		echo "Values in $entry -"
		IFS=:
		for value in entry
		do
			echo " $value"
		done
	done
	\end{lstlisting}

\section{控制循环}
\subsection{break命令}
	使用break命令可以退出任何类型的循环。不同于C语言的break命令，bash的break命令可以跳出多级循环，格式如下所示：
	\begin{lstlisting}
	# n是要跳出的循环级别
	break n
	# 如果不带参数，就是跳出所在的循环
	break
	\end{lstlisting}

	例子如下：
	\begin{lstlisting}
	#!/bin/bash

	for (( a=1; a < 4; a++ ))
	do
		echo "Outer loop: $a"
		for (( b=1; b < 100; b++ ))
		do
			if [ $b -gt 4]
			then
				break 2
			fi
		done
	done
	\end{lstlisting}

\subsection{continue命令}
	continue命令用于提前停止当前循环，和break命令一样，continue命令也可以指定要提前停止的循环级别，格式如下所示：
	\begin{lstlisting}
	# n是要提前停止的循环级别
	continue n
	# 不带参数是，就是提前停止当前循环
	continue
	\end{lstlisting}

	例子如下：
	\begin{lstlisting}
	#!/bin/bash

	for (( a=1; a <- 5; a++ ))
	do
		echo "Iteration $a:"
		for (( b=1; b < 3; b++ ))
		do
			if [ $a -gt 2 ] && [ $a -lt 4 ]
			then
				continue 2
			fi
			var3=$[ $a * $b ]
			echo "The result of $a * $b is $var3"
		done
	done
	\end{lstlisting}

\section{处理循环的输出}
	可以在done命令后面添加重定位输出符号或管道符号来向某个文件循环输出结果，例子如下所示：
	\begin{lstlisting}
	for file in /home/rich/*
	do
		if [ -d "$file" ]
		then
			echo "$file is a directory"
		elif
			echo "$file is a file"
		fi
	done > output.txt
	\end{lstlisting}

	使用管道的例子如下所示：
	\begin{lstlisting}
	#!/bin/bash
	for state in "North Dakota Connecticut Illinois Alabama Tennessee"
	do
		echo "$state is the next place to go"
	done | sort
	\end{lstlisting}

\section{shell中的判断条件}
	参考网站：\par
	\url{http://blog.csdn.net/ithomer/article/details/5904632}

\end{document}
